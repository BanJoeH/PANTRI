(this["webpackJsonprecipeshoppinglist2.0"]=this["webpackJsonprecipeshoppinglist2.0"]||[]).push([[7],{440:function(e,t,n){"use strict";var r=n(51);function c(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}n(1),n(442);var a=n(2),i=["handleChange","label"];t.a=function(e){var t=e.handleChange,n=e.label,s=c(e,i);return Object(a.jsxs)("div",{className:"group",children:[Object(a.jsx)("input",Object(r.a)(Object(r.a)({onChange:t},s),{},{className:"form-input"})),n?Object(a.jsx)("label",{className:"".concat(s.value.length?"shrink":""," form-input-label"),children:n}):null]})}},442:function(e,t,n){},455:function(e,t,n){},460:function(e,t,n){"use strict";n.r(t);var r=n(39),c=n.n(r),a=n(66),i=n(65),s=n(1),u=n(25),o=n(67),l=n(443),d=function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.doc(t.id).update(t).then(r="succeeded").catch((function(e){r="failed",console.log("error updating recipe",e)}));case 2:return e.abrupt("return",r);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),j=function(e,t){var n=Object(s.useState)(e),r=Object(i.a)(n,2),c=r[0],a=r[1];return Object(s.useEffect)((function(){var n=setTimeout((function(){a(e)}),t);return function(){clearTimeout(n)}}),[e,t]),c},b=n(449),p=n(440),f=(n(455),n(2)),O=function(e){var t=e.searchField,n=e.searchChange;return Object(f.jsx)("div",{className:"searchbox",children:Object(f.jsx)(p.a,{type:"search",label:"Search Recipes",onChange:n,value:t})})},h=n(142),g=n(51),v=n(439),m=n(446);var x=function(){var e=Object(s.useState)([{ingredient:"",ingredientRef:null}]),t=Object(i.a)(e,2),n=t[0],r=t[1],d=Object(s.useState)({name:"",link:"",ingredients:[]}),j=Object(i.a)(d,2),b=j[0],O=j[1],x=Object(s.useState)(!1),k=Object(i.a)(x,2),C=k[0],w=k[1],R=Object(s.useState)(!1),y=Object(i.a)(R,2),N=y[0],E=y[1],L=Object(o.useFirestore)(),S=Object(u.b)((function(e){return e.firebase.auth})).uid,D=L.collection("users").doc(S).collection("recipes"),A=function(e){var t=e.target,n=t.name,r=t.value;O(Object(g.a)(Object(g.a)({},b),{},Object(h.a)({},n,r)))},F=function(){var e=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),b.name){e.next=5;break}w(!0),e.next=9;break;case 5:return e.next=7,Object(l.a)(b,D);case 7:"error"===e.sent?Object(l.c)("Error","error adding new recipe, please try again","danger"):(w(!1),Object(l.c)(b.name,"Added to Recipes","success"),O({name:"",link:"",ingredients:[]}),r([{ingredient:"",ingredientRef:null}]),E(!N));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){var e=n.map((function(e,t){return e.ingredient.toLowerCase()})).filter(Boolean);O(Object(g.a)(Object(g.a)({},b),{},{ingredients:e}))}),[n]),N?Object(f.jsxs)("div",{className:"card",children:[Object(f.jsx)("h3",{className:"new-recipe-title",children:"Add a new recipe"}),Object(f.jsx)(p.a,{name:"name",label:"Recipe Name",handleChange:A,value:b.name,required:!0}),C?Object(f.jsx)("div",{className:"error",children:"Recipe name required"}):null,Object(f.jsx)(p.a,{name:"link",label:"Link",handleChange:A,value:b.link}),Object(f.jsx)(m.a,{inputList:n,setInputList:r,label:"Ingredient"}),Object(f.jsxs)("div",{className:"new-recipe-button-group",children:[Object(f.jsx)(v.a,{value:"AddRecipe",onClick:F,children:"Add Recipe"}),Object(f.jsx)(v.a,{value:"Cancel",onClick:function(e){e.preventDefault(),E(!1),w(!1)},children:"Cancel"})]})]}):Object(f.jsx)("div",{style:{margin:"0 5%"},children:Object(f.jsx)(v.a,{value:"newRecipe",onClick:function(e){e.preventDefault(),E(!N)},children:"Add a Recipe"})})},k=function(e){var t=e.editingRecipe,n=e.setEditingRecipe,r=e.updateRecipe,c=Object(s.useState)([{ingredient:"",ingredientRef:null}]),a=Object(i.a)(c,2),u=a[0],o=a[1];Object(s.useEffect)((function(){n((function(e){return Object(g.a)(Object(g.a)({},e),{},{ingredients:u.map((function(e){return e.ingredient})).filter(Boolean)})}))}),[u]),Object(s.useEffect)((function(){var e=[];if(!t.id)return[{ingredient:"",ingredientRef:null}];e=t.ingredients.map((function(e){return{ingredient:e,ingredientRef:null}})),o(e)}),[t.ingredients.length]);var l=function(e){n((function(t){return Object(g.a)(Object(g.a)({},t),{},Object(h.a)({},e.target.name,e.target.value))}))};return t.id?Object(f.jsxs)("article",{className:"card",children:[Object(f.jsx)("h2",{children:"Edit Recipe"}),Object(f.jsxs)("div",{className:"card-body",children:[Object(f.jsx)(p.a,{name:"name",label:"Recipe Name",handleChange:l,value:t.name,autoComplete:"off"}),Object(f.jsx)(p.a,{name:"link",label:"Link",handleChange:l,value:t.link,autoComplete:"off"}),Object(f.jsx)(m.a,{inputList:u,setInputList:o})]}),Object(f.jsxs)("div",{className:"new-recipe-button-group",children:[Object(f.jsx)(v.a,{value:"editRecipe",onClick:r,children:"Done"}),Object(f.jsx)(v.a,{value:"Cancel",onClick:function(e){e.preventDefault(),n({id:"",name:"",ingredients:[],link:""})},children:"Cancel"})]})]}):null},C=n(444),w=n(445);t.default=function(){var e=Object(s.useState)({id:"",name:"",link:"",ingredients:[]}),t=Object(i.a)(e,2),n=t[0],r=t[1],p=Object(s.useState)(""),h=Object(i.a)(p,2),g=h[0],v=h[1],m=j(g,200),R=Object(o.useFirestore)(),y=Object(u.b)((function(e){return e.firebase.auth.uid})),N=Object(u.b)((function(e){return e.firestore.ordered.recipes})),E=Object(u.b)((function(e){return e.firestore.status.requesting.recipes})),L=Object(u.b)((function(e){return e.firestore.status.requested.recipes})),S=function(e,t){var n=[];return e?t?(e.forEach((function(e){e.name&&e.ingredients.length&&(e.name.toLowerCase().includes(t.toLowerCase())||e.ingredients.some((function(e){return e.toLowerCase().includes(t.toLowerCase())})))&&n.push(e)})),n):e:n}(N,m);Object(o.useFirestoreConnect)({collection:"users/".concat(y,"/recipes"),storeAs:"recipes"});var D=R.collection("users").doc(y).collection("shoppingList"),A=R.collection("users").doc(y).collection("recipes"),F=function(){var e=Object(a.a)(c.a.mark((function e(t){var n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!window.confirm("Are you sure you want to permanently delete this recipe?")){e.next=8;break}return n=t.target.value,r=Object(l.b)(n,N),e.next=6,Object(l.d)(r,A);case 6:"error"===(a=e.sent)?Object(l.c)("Error","error removing recipe, please try again","danger"):Object(l.c)(a.name,"Deleted","success");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(a.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=Object(l.b)(t.target.value,N),e.next=4,Object(l.a)(n,D);case 4:"error"===(r=e.sent)?Object(l.c)("Error","error adding to shopping list","danger"):(Object(l.c)(r.name,"Added to your shopping list","success"),v(""));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,d(n,A);case 3:"succeeded"===e.sent?(r({id:"",name:"",link:"",ingredients:[]}),Object(l.c)(n.name,"updated","info")):Object(l.c)("Error","error updating recipe, please try again","info");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return!E&&Object(f.jsxs)(C.a,{children:[Object(f.jsxs)(w.a,{title:"Recipe List",children:[Object(f.jsx)(k,{editingRecipe:n,setEditingRecipe:r,updateRecipe:B}),Object(f.jsx)(x,{}),Object(f.jsx)(O,{searchChange:function(e){v(e.target.value)},searchField:g})]}),!E&&L&&S.length?Object(f.jsx)(b.a,{recipes:S,removeFromRecipes:F,cardButton:q,editRecipeCardButton:function(e){e.preventDefault();var t=Object(l.b)(e.target.value,N);void 0===t?Object(l.c)("error","error finding recipe, please contact admin to resolve issue","danger"):r(t)}}):g?Object(f.jsx)("div",{className:"card",children:Object(f.jsx)("h2",{children:"Recipe not found."})}):Object(f.jsxs)("div",{className:"card",children:[Object(f.jsx)("h2",{children:"No recipes in your recipe list."}),Object(f.jsx)("h2",{children:"Click add a recipe above to add some!"})]})]})}}}]);
//# sourceMappingURL=7.c25e06af.chunk.js.map