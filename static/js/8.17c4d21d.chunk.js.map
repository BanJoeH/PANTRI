{"version":3,"sources":["components/oddbits/oddbits.component.jsx","components/sort-shopping/sort-shopping.component.jsx","pages/shopping-list/shopping-list.component.js","pages/shopping-list/shopping-list.utils.js"],"names":["OddBits","oddBits","useSelector","state","firebase","profile","uid","auth","firestore","useFirestore","useState","ingredient","ingredientRef","inputList","setInputList","useEffect","length","map","item","updateOddBits","ingredients","input","collection","doc","set","merge","className","lossOfFocus","label","SortShopping","recipes","showSort","setShowSort","id","name","link","sortShoppingRecipe","setSortShoppingRecipe","togleShowSort","removeIngredient","event","ingredientToRemove","target","split","temp","filter","sortAllIngredients","ingredientListSorted","recipe","flat","sort","Set","value","str","removeFromRecipes","button","ingredientButton","e","preventDefault","style","margin","onClick","formattedIngredients","ShoppingList","isLoading","status","requesting","shoppingList","history","useHistory","useFirestoreConnect","storeAs","ordered","shoppingListCollectionRef","handleRemoveFromShoppingClick","a","recipeId","recipeToRemove","findRecipe","removeFromFirebaseCollection","response","notification","title","cardButton","ingredientIndex","updatedIngredients","slice","splice","ref","update","removeIngredientFromShoppingList","push","cursor"],"mappings":"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","file":"static/js/8.17c4d21d.chunk.js","sourcesContent":["import { useState, useEffect } from \"react\";\nimport IngredientInput from \"../ingredient-input/ingredient-input.component.js\";\nimport { useFirestore } from \"react-redux-firebase\";\nimport { useSelector } from \"react-redux\";\n\nconst OddBits = () => {\n  const oddBits = useSelector((state) => state.firebase.profile.oddBits);\n  const { uid } = useSelector((state) => state.firebase.auth);\n\n  const firestore = useFirestore();\n\n  const [inputList, setInputList] = useState([\n    { ingredient: \"\", ingredientRef: null },\n  ]);\n\n  useEffect(() => {\n    if (oddBits?.length) {\n      setInputList(\n        oddBits.map((item) => ({\n          ingredient: item,\n          ingredientRef: null,\n        }))\n      );\n    }\n  }, [oddBits]);\n\n  const handleOnBlur = () => {\n    updateOddBits(inputList, uid);\n  };\n\n  const updateOddBits = (inputList, uid) => {\n    let ingredients = inputList.map((input) => {\n      return input.ingredient;\n    });\n    firestore.collection(\"users\").doc(uid).set(\n      {\n        oddBits: ingredients,\n      },\n      { merge: true }\n    );\n  };\n\n  return (\n    <article className=\"card\">\n      <div className=\"card-header\">\n        <h2 className=\"card-title\">Odd Bits</h2>\n      </div>\n      <div className=\"card-body \">\n        <IngredientInput\n          inputList={inputList}\n          setInputList={setInputList}\n          lossOfFocus={handleOnBlur}\n          label=\"Odd bit\"\n        />\n      </div>\n    </article>\n  );\n};\n\nexport default OddBits;\n","import React, { useState } from \"react\";\nimport Card from \"../card/card.component\";\nimport CustomButton from \"../custom-button/custom-button.component\";\n\nconst SortShopping = ({ recipes }) => {\n  const [showSort, setShowSort] = useState(false);\n  const [sortShoppingRecipe, setSortShoppingRecipe] = useState({\n    id: \"sort\",\n    name: \"Sorted Shopping List\",\n    link: \"\",\n    ingredients: [],\n  });\n\n  const togleShowSort = () => {\n    setShowSort(!showSort);\n  };\n\n  const handleRemoveIngredientClick = (e) => {\n    e.preventDefault();\n    const ingredients = sortShoppingRecipe.ingredients;\n    removeIngredient(e, ingredients);\n  };\n\n  const removeIngredient = (event, ingredients) => {\n    const ingredientToRemove = event.target.name.split(\"&\")[1];\n\n    const temp = ingredients.filter(\n      (ingredient) => ingredient !== ingredientToRemove\n    );\n    setSortShoppingRecipe({ ...sortShoppingRecipe, ingredients: temp });\n  };\n\n  const handleSortClick = (e) => {\n    e.preventDefault();\n    const formattedIngredients = sortAllIngredients(recipes);\n    setSortShoppingRecipe((state) => {\n      return {\n        ...state,\n        ingredients: formattedIngredients,\n      };\n    });\n    togleShowSort();\n  };\n\n  const sortAllIngredients = (recipes) => {\n    const ingredientListSorted = recipes\n      .map((recipe) => {\n        return recipe.ingredients;\n      })\n      .flat()\n      .sort();\n    const unique = [...new Set(ingredientListSorted)];\n    const duplicates = unique.map((value) => [\n      value,\n      ingredientListSorted.filter((str) => str === value).length,\n    ]);\n    const formatted = duplicates.map(\n      (ingredient) => ingredient[0] + \"  X\" + ingredient[1]\n    );\n\n    return formatted;\n  };\n\n  return showSort ? (\n    <Card\n      recipe={sortShoppingRecipe}\n      removeFromRecipes={togleShowSort}\n      button={togleShowSort}\n      ingredientButton={handleRemoveIngredientClick}\n    />\n  ) : (\n    <div style={{ margin: \"0 5%\" }}>\n      <CustomButton value=\"Sort shopping\" onClick={handleSortClick}>\n        Sort Shopping\n      </CustomButton>\n    </div>\n  );\n};\n\nexport default SortShopping;\n","import React from \"react\";\n\nimport { useFirestoreConnect, useFirestore } from \"react-redux-firebase\";\n\nimport { useSelector } from \"react-redux\";\nimport { removeIngredientFromShoppingList } from \"./shopping-list.utils\";\n\nimport OddBits from \"../../components/oddbits/oddbits.component.jsx\";\nimport CardList from \"../../components/cardList/card-list.component.jsx\";\nimport SortShopping from \"../../components/sort-shopping/sort-shopping.component.jsx\";\nimport {\n  findRecipe,\n  removeFromFirebaseCollection,\n  notification,\n} from \"../../App/app.utils\";\nimport PageContainer from \"../../components/page-container/page-container\";\nimport PageHeaderContainer from \"../../components/page-header-container/page-header-container\";\nimport { useHistory } from \"react-router\";\n\nconst ShoppingList = () => {\n  const { uid } = useSelector((state) => state.firebase.auth);\n  const isLoading = useSelector(\n    (state) => state.firestore.status.requesting.shoppingList\n  );\n  const history = useHistory();\n\n  useFirestoreConnect({\n    collection: `users/${uid}/shoppingList`,\n    storeAs: \"shoppingList\",\n  });\n\n  const firestore = useFirestore();\n  const recipes = useSelector((state) => state.firestore.ordered.shoppingList);\n\n  const shoppingListCollectionRef = firestore\n    .collection(\"users\")\n    .doc(uid)\n    .collection(\"shoppingList\");\n\n  const handleRemoveFromShoppingClick = async (e) => {\n    e.preventDefault();\n\n    const recipeId = e.target.value;\n    const recipeToRemove = findRecipe(recipeId, recipes);\n    const response = await removeFromFirebaseCollection(\n      recipeToRemove,\n      shoppingListCollectionRef\n    );\n    if (response === \"error\") {\n      notification(\n        \"Error\",\n        \"Error removing recipe, please try again\",\n        \"danger\"\n      );\n    } else {\n      notification(response.name, \"Deleted\", \"success\");\n    }\n  };\n\n  const handleRemoveIngredientFromShoppingListItemClick = (e) => {\n    e.preventDefault();\n    const [recipeId, , ingredientIndex] = e.target.name.split(\"&\");\n    const recipe = findRecipe(recipeId, recipes);\n    const updatedIngredients = recipe.ingredients.slice();\n    updatedIngredients.splice(ingredientIndex, 1);\n\n    removeIngredientFromShoppingList(\n      recipeId,\n      updatedIngredients,\n      shoppingListCollectionRef\n    );\n  };\n\n  return (\n    !isLoading && (\n      <PageContainer>\n        <PageHeaderContainer title=\"Shopping List\">\n          <OddBits />\n          {recipes?.length ? <SortShopping recipes={recipes} /> : null}\n        </PageHeaderContainer>\n        {recipes?.length ? (\n          <CardList\n            recipes={recipes}\n            removeFromRecipes={handleRemoveFromShoppingClick}\n            cardButton={handleRemoveFromShoppingClick}\n            ingredientButton={handleRemoveIngredientFromShoppingListItemClick}\n          />\n        ) : (\n          <div\n            className=\"card\"\n            onClick={() => {\n              history.push(\"/PANTRI/recipes\");\n            }}\n            style={{ cursor: \"pointer\" }}\n          >\n            <h2>No recipes in your shopping list.</h2>\n            <h2>Go to Recipes to add some!</h2>\n          </div>\n        )}\n      </PageContainer>\n    )\n  );\n};\n\nexport default ShoppingList;\n","export const removeRecipeFromShoppingList = (recipeId, ref) => {\n  ref\n    .doc(recipeId)\n    .delete()\n    .catch((error) => {\n      console.log(\"error removing document\", error);\n    });\n};\n\nexport const removeIngredientFromShoppingList = (\n  recipeId,\n  updatedIngredients,\n  ref\n) => {\n  ref.doc(recipeId).update(\n    {\n      ingredients: updatedIngredients,\n    },\n    { merge: true }\n  );\n};\n"],"sourceRoot":""}